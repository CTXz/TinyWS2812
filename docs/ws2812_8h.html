<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tiny-WS2812: include/ws2812.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Tiny-WS2812
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">A tiny cross-platform WS2812 LED Strip driver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ws2812.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Exposes the Tiny-WS2812 library interface.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="ws2812__avr_8h_source.html">ws2812_avr.h</a>&quot;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
<code>#include &quot;<a class="el" href="ws2812__common_8h_source.html">ws2812_common.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ws2812.h:</div>
<div class="dyncontent">
<div class="center"><img src="ws2812_8h__incl.png" border="0" usemap="#include_2ws2812_8h" alt=""/></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="ws2812_8h__dep__incl.png" border="0" usemap="#include_2ws2812_8hdep" alt=""/></div>
</div>
</div>
<p><a href="ws2812_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abb76184063c2d58324bde5457e32bee0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812_8h.html#abb76184063c2d58324bde5457e32bee0">_ws2812_get_rgbmap</a> (uint8_t(*rgbmap)[3], <a class="el" href="ws2812__common_8h.html#a8748d3b90dd6acafed50ff0cf34034dd">ws2812_order</a> order)</td></tr>
<tr class="memdesc:abb76184063c2d58324bde5457e32bee0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a rgb map for a given color order.  <a href="ws2812_8h.html#abb76184063c2d58324bde5457e32bee0">More...</a><br /></td></tr>
<tr class="separator:abb76184063c2d58324bde5457e32bee0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad08c3092fa4ac89001493828d5a4665d"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812_8h.html#ad08c3092fa4ac89001493828d5a4665d">ws2812_config</a> (<a class="el" href="structws2812.html">ws2812</a> *dev, <a class="el" href="structws2812__cfg.html">ws2812_cfg</a> config)</td></tr>
<tr class="memdesc:ad08c3092fa4ac89001493828d5a4665d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures a <a class="el" href="structws2812.html">WS2812 device struct</a>.  <a href="ws2812_8h.html#ad08c3092fa4ac89001493828d5a4665d">More...</a><br /></td></tr>
<tr class="separator:ad08c3092fa4ac89001493828d5a4665d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ac53e8d64e1fc6073e85ea0fd80a975"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812_8h.html#a8ac53e8d64e1fc6073e85ea0fd80a975">ws2812_prep_tx</a> (<a class="el" href="structws2812.html">ws2812</a> *dev)</td></tr>
<tr class="memdesc:a8ac53e8d64e1fc6073e85ea0fd80a975"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepares the host device for data transmission.  <a href="ws2812_8h.html#a8ac53e8d64e1fc6073e85ea0fd80a975">More...</a><br /></td></tr>
<tr class="separator:a8ac53e8d64e1fc6073e85ea0fd80a975"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2db6a7db2e9f0a57921b01037202e15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812_8h.html#af2db6a7db2e9f0a57921b01037202e15">ws2812_tx</a> (<a class="el" href="structws2812.html">ws2812</a> *dev, <a class="el" href="structws2812__rgb.html">ws2812_rgb</a> *pxls, size_t n_pxls)</td></tr>
<tr class="memdesc:af2db6a7db2e9f0a57921b01037202e15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmits RGB values to the provided <a class="el" href="structws2812.html">WS2812 device</a>.  <a href="ws2812_8h.html#af2db6a7db2e9f0a57921b01037202e15">More...</a><br /></td></tr>
<tr class="separator:af2db6a7db2e9f0a57921b01037202e15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eb0bca405f4e5cffbed88230fd35038"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812_8h.html#a2eb0bca405f4e5cffbed88230fd35038">ws2812_wait_rst</a> (<a class="el" href="structws2812.html">ws2812</a> *dev)</td></tr>
<tr class="memdesc:a2eb0bca405f4e5cffbed88230fd35038"><td class="mdescLeft">&#160;</td><td class="mdescRight">Waits for the <a class="el" href="structws2812.html">WS2812 device</a> to reset.  <a href="ws2812_8h.html#a2eb0bca405f4e5cffbed88230fd35038">More...</a><br /></td></tr>
<tr class="separator:a2eb0bca405f4e5cffbed88230fd35038"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c2ce6b9d36f5c768bfdd781812aea34"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812_8h.html#a0c2ce6b9d36f5c768bfdd781812aea34">ws2812_close_tx</a> (<a class="el" href="structws2812.html">ws2812</a> *dev)</td></tr>
<tr class="memdesc:a0c2ce6b9d36f5c768bfdd781812aea34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes a WS2812 transmission.  <a href="ws2812_8h.html#a0c2ce6b9d36f5c768bfdd781812aea34">More...</a><br /></td></tr>
<tr class="separator:a0c2ce6b9d36f5c768bfdd781812aea34"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Exposes the Tiny-WS2812 library interface. </p>
<dl class="section author"><dt>Author</dt><dd>Patrick Pedersen </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2021-04-09</dd></dl>
<p>The Tiny-WS2812 library initially derives from the driver code of an open source WS2812 LED controller that I had worked on prior, and provides a nearly barebone interface to communicate with WS2812 LED devices.</p>
<p>The following platforms and frameworks are currently supported:</p><ul>
<li>Barebone AVR</li>
<li>The Arduino Framework (Currently only AVR based (eg. Uno, Leonardo, Micro...))</li>
</ul>
<p>It has been developed out of the necessity to have an extremely light weight and flexible cross-platform library that can be further abstracted and used troughout my WS2812 projects, particullary on MCUs with severe memory constraints (ex. ATTiny chips), where one cannot just define an RGB array equivalent to the number of LEDs. This libraries purpose is <b>NOT</b> to provide fancy abstractions and functions for color correction, brightness settings, animations etc.</p>
<p>To summerize, this library is inteded to:</p><ul>
<li>be used on MCUs with limited computing resources.</li>
<li>act as a base for more abstract WS2812 libraries.</li>
<li>be easily portable to other platforms or programming frameworks (ex. Arduino).</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Because the motivation of this library is to be as barebone as possible, it relies on a superficial understanding of the WS2812 protocol and may demand an understanding of the host platforms platform (eg. registers etc.). For quick and simple programming of WS2812 devices, where memory and processing power are not a big issue, other libraries should probably be consulted. <br  />
 </dd></dl>

<p class="definition">Definition in file <a class="el" href="ws2812_8h_source.html">ws2812.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="abb76184063c2d58324bde5457e32bee0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb76184063c2d58324bde5457e32bee0">&#9670;&nbsp;</a></span>_ws2812_get_rgbmap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ws2812_get_rgbmap </td>
          <td>(</td>
          <td class="paramtype">uint8_t(*)&#160;</td>
          <td class="paramname"><em>rgbmap</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ws2812__common_8h.html#a8748d3b90dd6acafed50ff0cf34034dd">ws2812_order</a>&#160;</td>
          <td class="paramname"><em>order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a rgb map for a given color order. </p>
<p>The following function is intended only to be used for internal library code, hence the _ prefix. It fills a 3 element byte array with the necessary offsets to map/convert RGB values to a different color order. For example, setting the order to <code>rgb</code> fills the rgb map with <code>0, 1, 2</code> and <code>bgr</code> fill the rgb map with <code>2, 1, 0</code>, etc. </p>

<p class="definition">Definition at line <a class="el" href="ws2812__common_8cxx_source.html#l00043">43</a> of file <a class="el" href="ws2812__common_8cxx_source.html">ws2812_common.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">switch</span> (order) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                <span class="keywordflow">case</span> rbg:</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                        memcpy(rgbmap, ws2812_order_rbg, 3);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                <span class="keywordflow">case</span> brg:</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                        memcpy(rgbmap, ws2812_order_brg, 3);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                <span class="keywordflow">case</span> bgr:</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                        memcpy(rgbmap, ws2812_order_bgr, 3);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                <span class="keywordflow">case</span> grb:</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                        memcpy(rgbmap, ws2812_order_grb, 3);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                <span class="keywordflow">case</span> gbr:</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                        memcpy(rgbmap, ws2812_order_gbr, 3);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                <span class="keywordflow">default</span>: <span class="comment">// rgb</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                        memcpy(rgbmap, ws2812_order_rgb, 3);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c2ce6b9d36f5c768bfdd781812aea34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c2ce6b9d36f5c768bfdd781812aea34">&#9670;&nbsp;</a></span>ws2812_close_tx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ws2812_close_tx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structws2812.html">ws2812</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes a WS2812 transmission. </p>
<p>The following function should be called after ending data transmission with a WS2812 device. The exact closing procedure is platform specific but will typically involve restoring stashed registers to their previous states, re-enable interrupts, wait for the WS2812 to reset by calling <a class="el" href="ws2812_8h.html#a2eb0bca405f4e5cffbed88230fd35038" title="Waits for the WS2812 device to reset.">ws2812_wait_rst()</a>, and potentially alter fields of the provided <a class="el" href="structws2812.html">WS2812 device struct</a>. </p>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8cxx_source.html#l00272">272</a> of file <a class="el" href="ws2812__avr_8cxx_source.html">ws2812_avr.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;{</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">if</span> (_prep == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                SREG = _sreg_prev;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                sei();</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                _prep = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <a class="code" href="ws2812__avr_8cxx.html#a2eb0bca405f4e5cffbed88230fd35038">ws2812_wait_rst</a>(dev);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad08c3092fa4ac89001493828d5a4665d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad08c3092fa4ac89001493828d5a4665d">&#9670;&nbsp;</a></span>ws2812_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t ws2812_config </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structws2812.html">ws2812</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structws2812__cfg.html">ws2812_cfg</a>&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configures a <a class="el" href="structws2812.html">WS2812 device struct</a>. </p>
<p>The following function initializes/configures a <a class="el" href="structws2812.html">WS2812 device struct</a> using a <a class="el" href="structws2812__cfg.html">ws2812_cfg configuration struct</a>. </p>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8cxx_source.html#l00126">126</a> of file <a class="el" href="ws2812__avr_8cxx_source.html">ws2812_avr.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;{</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        <span class="keywordflow">if</span> (config.<a class="code" href="structws2812__cfg.html#a2a6404a5d1e6d8829e2abcf5d916715b">n_dev</a> == 0)</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                <span class="keywordflow">return</span> 1; <span class="comment">// No devices to be driven!</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        uint8_t pin_msk = 0;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor">#ifdef WS2812_TARGET_PLATFORM_ARDUINO_AVR</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; config.<a class="code" href="structws2812__cfg.html#a2a6404a5d1e6d8829e2abcf5d916715b">n_dev</a>; i++) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                <span class="keywordflow">if</span> (i+1 &lt; config.<a class="code" href="structws2812__cfg.html#a2a6404a5d1e6d8829e2abcf5d916715b">n_dev</a> &amp;&amp;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                    digitalPinToPort(config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[i]) != digitalPinToPort(config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[i+1]))</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                        <span class="keywordflow">return</span> 2; <span class="comment">// Pins do not share same port!</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                pinMode(config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[i], OUTPUT);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                pin_msk |= digitalPinToBitMask(config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[i]);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        dev-&gt;<a class="code" href="structws2812.html#af8a9e3c5bbc7cd936d94ad33bca218dd">port</a> = portOutputRegister(digitalPinToPort(config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[0]));</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; config.<a class="code" href="structws2812__cfg.html#a2a6404a5d1e6d8829e2abcf5d916715b">n_dev</a>; i++)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                pin_msk |= 1 &lt;&lt; config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[i];</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        *config.<a class="code" href="structws2812__cfg.html#a05c7bc58ea6e94f80e5b4b7f0ab3a554">ddr</a> = pin_msk;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        dev-&gt;<a class="code" href="structws2812.html#af8a9e3c5bbc7cd936d94ad33bca218dd">port</a> = config.<a class="code" href="structws2812__cfg.html#a68fff035f1137f78fc80e9f9bc0fb831">port</a>;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;#endif</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        dev-&gt;<a class="code" href="structws2812.html#aac098f9c6f0f802c066122e0166d6970">rst_time_us</a> = config.<a class="code" href="structws2812__cfg.html#a9131a1de83995aa8c917e1a3c6ee1fa5">rst_time_us</a>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        dev-&gt;<a class="code" href="structws2812.html#ad04d92a4b1276fbb588960ad009b67b9">masklo</a> = ~pin_msk &amp; *(dev-&gt;<a class="code" href="structws2812.html#af8a9e3c5bbc7cd936d94ad33bca218dd">port</a>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        dev-&gt;<a class="code" href="structws2812.html#ae191c20dea8f9cca0bb92e9d0431f721">maskhi</a> = pin_msk | *(dev-&gt;<a class="code" href="structws2812.html#af8a9e3c5bbc7cd936d94ad33bca218dd">port</a>);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <a class="code" href="ws2812__common_8cxx.html#abb76184063c2d58324bde5457e32bee0">_ws2812_get_rgbmap</a>(&amp;dev-&gt;<a class="code" href="structws2812.html#a8d961104f06a5bd3f8109f0b6a89f142">rgbmap</a>, config.<a class="code" href="structws2812__cfg.html#ad50d0defcc33c93e648889222b93c1aa">order</a>);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ac53e8d64e1fc6073e85ea0fd80a975"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ac53e8d64e1fc6073e85ea0fd80a975">&#9670;&nbsp;</a></span>ws2812_prep_tx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ws2812_prep_tx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structws2812.html">ws2812</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepares the host device for data transmission. </p>
<p>The following function prepares the host device for data transmission. The exact preperation procedure is platform specific, but typically will involve disabling interrupts, stashing registers that may be modified when communicating to the WS2812 device and potentially preparing the passed <a class="el" href="structws2812.html">WS2812 device struct</a> for data transmission. For a more detailed understanding, please refer to the platform specific code of this function.</p>
<dl class="section warning"><dt>Warning</dt><dd>Always call this function before making any calls to <a class="el" href="ws2812_8h.html#af2db6a7db2e9f0a57921b01037202e15" title="Transmits RGB values to the provided WS2812 device.">ws2812_tx()</a>! Not doing so may result in undefined behaivour! </dd></dl>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8cxx_source.html#l00159">159</a> of file <a class="el" href="ws2812__avr_8cxx_source.html">ws2812_avr.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;{</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        <span class="keywordflow">if</span> (_prep == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                _sreg_prev = SREG;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                cli();</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                _prep = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af2db6a7db2e9f0a57921b01037202e15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2db6a7db2e9f0a57921b01037202e15">&#9670;&nbsp;</a></span>ws2812_tx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ws2812_tx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structws2812.html">ws2812</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structws2812__rgb.html">ws2812_rgb</a> *&#160;</td>
          <td class="paramname"><em>pxls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_pxls</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmits RGB values to the provided <a class="el" href="structws2812.html">WS2812 device</a>. </p>
<p>The following function transmits RGB values to the provided <a class="el" href="structws2812.html">WS2812 device</a>. Calling this function consecutively for the same device will continue programming LEDs after the position where the last transmission has ended. In other words, calling the function consecutively for the same device will <b>NOT</b> program the device from the first LED, but rather take off from where it last ended. If this is not desired, call <a class="el" href="ws2812_8h.html#a2eb0bca405f4e5cffbed88230fd35038" title="Waits for the WS2812 device to reset.">ws2812_wait_rst()</a> after each transmission. </p>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8cxx_source.html#l00261">261</a> of file <a class="el" href="ws2812__avr_8cxx_source.html">ws2812_avr.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;{</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n_leds; i++) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                <span class="keywordflow">for</span> (uint8_t j = 0; j &lt; <span class="keyword">sizeof</span>(dev-&gt;<a class="code" href="structws2812.html#a8d961104f06a5bd3f8109f0b6a89f142">rgbmap</a>); j++) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                        uint8_t *pxl = (uint8_t *) &amp;(<a class="code" href="arduino__avr_2blink__array_8cxx.html#a69b7b102ebcf421b7170ebe2926126e4">leds</a>[i]);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                        <a class="code" href="ws2812__avr_8cxx.html#ae286d1f394d345649b3ad08404fcfed5">ws2812_tx_byte</a>(dev, pxl[dev-&gt;<a class="code" href="structws2812.html#a8d961104f06a5bd3f8109f0b6a89f142">rgbmap</a>[j]]);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        }</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2eb0bca405f4e5cffbed88230fd35038"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eb0bca405f4e5cffbed88230fd35038">&#9670;&nbsp;</a></span>ws2812_wait_rst()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ws2812_wait_rst </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structws2812.html">ws2812</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Waits for the <a class="el" href="structws2812.html">WS2812 device</a> to reset. </p>
<p>The following function waits for the <a class="el" href="structws2812.html">WS2812 device</a> to reset, thus allowing it to be overwritten from the first LED again. The reset time is configuredin the <a class="el" href="structws2812__cfg.html" title="Data structure to configure a WS2812 device struct on AVR platforms.">ws2812_cfg</a> object used to initialize/configure the passed <a class="el" href="structws2812.html">WS2812 device struct</a>, and is recommended to be 50us according to the WS2812 datasheet, but may be set significantly lower for some WS2812 devices. Call this function if you wish to overwritte the WS2812 device after a previous <a class="el" href="ws2812_8h.html#af2db6a7db2e9f0a57921b01037202e15" title="Transmits RGB values to the provided WS2812 device.">ws2812_tx()</a> call.</p>
<dl class="section note"><dt>Note</dt><dd>This function does not have to be called prior calling #ws2812_end_tx() as it already contains a call to <a class="el" href="ws2812_8h.html#a2eb0bca405f4e5cffbed88230fd35038" title="Waits for the WS2812 device to reset.">ws2812_wait_rst()</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8cxx_source.html#l00169">169</a> of file <a class="el" href="ws2812__avr_8cxx_source.html">ws2812_avr.cxx</a>.</p>
<div class="fragment"><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;{</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#ifdef WS2812_TARGET_PLATFORM_ARDUINO_AVR</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        delayMicroseconds(dev-&gt;<a class="code" href="structws2812.html#aac098f9c6f0f802c066122e0166d6970">rst_time_us</a>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <a class="code" href="ws2812__avr_8cxx.html#a8069aef456aba6f66b80ac92a4746a32">delay_us</a>(dev-&gt;<a class="code" href="structws2812.html#aac098f9c6f0f802c066122e0166d6970">rst_time_us</a>);</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<div class="ttc" id="astructws2812_html_aac098f9c6f0f802c066122e0166d6970"><div class="ttname"><a href="structws2812.html#aac098f9c6f0f802c066122e0166d6970">ws2812::rst_time_us</a></div><div class="ttdeci">uint8_t rst_time_us</div><div class="ttdoc">Time required for WS2812 to reset in us.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00080">ws2812_avr.h:80</a></div></div>
<div class="ttc" id="aws2812__avr_8cxx_html_a2eb0bca405f4e5cffbed88230fd35038"><div class="ttname"><a href="ws2812__avr_8cxx.html#a2eb0bca405f4e5cffbed88230fd35038">ws2812_wait_rst</a></div><div class="ttdeci">void ws2812_wait_rst(ws2812 *dev)</div><div class="ttdoc">Waits for the WS2812 device to reset.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8cxx_source.html#l00169">ws2812_avr.cxx:169</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_a9131a1de83995aa8c917e1a3c6ee1fa5"><div class="ttname"><a href="structws2812__cfg.html#a9131a1de83995aa8c917e1a3c6ee1fa5">ws2812_cfg::rst_time_us</a></div><div class="ttdeci">uint8_t rst_time_us</div><div class="ttdoc">Time required for WS2812 to reset in us.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00061">ws2812_avr.h:61</a></div></div>
<div class="ttc" id="aws2812__avr_8cxx_html_ae286d1f394d345649b3ad08404fcfed5"><div class="ttname"><a href="ws2812__avr_8cxx.html#ae286d1f394d345649b3ad08404fcfed5">ws2812_tx_byte</a></div><div class="ttdeci">void ws2812_tx_byte(ws2812 *dev, uint8_t byte)</div><div class="ttdoc">Transmits a byte of data to the WS2812 device.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8cxx_source.html#l00191">ws2812_avr.cxx:191</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_a68fff035f1137f78fc80e9f9bc0fb831"><div class="ttname"><a href="structws2812__cfg.html#a68fff035f1137f78fc80e9f9bc0fb831">ws2812_cfg::port</a></div><div class="ttdeci">volatile uint8_t * port</div><div class="ttdoc">PORT Register (ex. PORTB, PORTC, PORTD...)</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00052">ws2812_avr.h:52</a></div></div>
<div class="ttc" id="aarduino__avr_2blink__array_8cxx_html_a69b7b102ebcf421b7170ebe2926126e4"><div class="ttname"><a href="arduino__avr_2blink__array_8cxx.html#a69b7b102ebcf421b7170ebe2926126e4">leds</a></div><div class="ttdeci">ws2812_rgb leds[N_LEDS]</div><div class="ttdoc">RGB array which represents the LEDs.</div><div class="ttdef"><b>Definition:</b> <a href="arduino__avr_2blink__array_8cxx_source.html#l00055">blink_array.cxx:55</a></div></div>
<div class="ttc" id="astructws2812_html_ad04d92a4b1276fbb588960ad009b67b9"><div class="ttname"><a href="structws2812.html#ad04d92a4b1276fbb588960ad009b67b9">ws2812::masklo</a></div><div class="ttdeci">uint8_t masklo</div><div class="ttdoc">PORT masks to toggle the data pins low.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00082">ws2812_avr.h:82</a></div></div>
<div class="ttc" id="aws2812__avr_8cxx_html_a8069aef456aba6f66b80ac92a4746a32"><div class="ttname"><a href="ws2812__avr_8cxx.html#a8069aef456aba6f66b80ac92a4746a32">delay_us</a></div><div class="ttdeci">void delay_us(uint8_t us)</div><div class="ttdoc">Halts the program for a given ammount of microseconds.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8cxx_source.html#l00116">ws2812_avr.cxx:116</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_a2a6404a5d1e6d8829e2abcf5d916715b"><div class="ttname"><a href="structws2812__cfg.html#a2a6404a5d1e6d8829e2abcf5d916715b">ws2812_cfg::n_dev</a></div><div class="ttdeci">uint8_t n_dev</div><div class="ttdoc">Number of WS2812 devices driven.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00063">ws2812_avr.h:63</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_ae4f693b8495942acae05da3df3bcfa58"><div class="ttname"><a href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">ws2812_cfg::pins</a></div><div class="ttdeci">uint8_t * pins</div><div class="ttdoc">Array of pins used to program WS2812 devices (Must share the same PORT! (ex. PB0, PB1,...</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00054">ws2812_avr.h:54</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_ad50d0defcc33c93e648889222b93c1aa"><div class="ttname"><a href="structws2812__cfg.html#ad50d0defcc33c93e648889222b93c1aa">ws2812_cfg::order</a></div><div class="ttdeci">ws2812_order order</div><div class="ttdoc">Color order (ex. rgb, grb, bgr...)</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00062">ws2812_avr.h:62</a></div></div>
<div class="ttc" id="astructws2812_html_a8d961104f06a5bd3f8109f0b6a89f142"><div class="ttname"><a href="structws2812.html#a8d961104f06a5bd3f8109f0b6a89f142">ws2812::rgbmap</a></div><div class="ttdeci">uint8_t rgbmap[3]</div><div class="ttdoc">RGB map to map/convert RGB values to another color order.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00083">ws2812_avr.h:83</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_a05c7bc58ea6e94f80e5b4b7f0ab3a554"><div class="ttname"><a href="structws2812__cfg.html#a05c7bc58ea6e94f80e5b4b7f0ab3a554">ws2812_cfg::ddr</a></div><div class="ttdeci">volatile uint8_t * ddr</div><div class="ttdoc">Data Direction Register (ex. DDRB, DDRC, DDRD...)</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00053">ws2812_avr.h:53</a></div></div>
<div class="ttc" id="astructws2812_html_af8a9e3c5bbc7cd936d94ad33bca218dd"><div class="ttname"><a href="structws2812.html#af8a9e3c5bbc7cd936d94ad33bca218dd">ws2812::port</a></div><div class="ttdeci">volatile uint8_t * port</div><div class="ttdoc">PORT register of pins used to drive the WS2812 device(s).</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00079">ws2812_avr.h:79</a></div></div>
<div class="ttc" id="aws2812__common_8cxx_html_abb76184063c2d58324bde5457e32bee0"><div class="ttname"><a href="ws2812__common_8cxx.html#abb76184063c2d58324bde5457e32bee0">_ws2812_get_rgbmap</a></div><div class="ttdeci">void _ws2812_get_rgbmap(uint8_t(*rgbmap)[3], ws2812_order order)</div><div class="ttdoc">Initializes a rgb map for a given color order.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__common_8cxx_source.html#l00043">ws2812_common.cxx:43</a></div></div>
<div class="ttc" id="astructws2812_html_ae191c20dea8f9cca0bb92e9d0431f721"><div class="ttname"><a href="structws2812.html#ae191c20dea8f9cca0bb92e9d0431f721">ws2812::maskhi</a></div><div class="ttdeci">uint8_t maskhi</div><div class="ttdoc">PORT masks to toggle the data pins high.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00081">ws2812_avr.h:81</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
