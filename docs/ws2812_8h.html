<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tiny-WS2812: include/ws2812.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Tiny-WS2812
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">A tiny cross-platform WS2812 LED Strip driver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ws2812.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Exposes the Tiny-WS2812 driver interface.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdint.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ws2812.h:</div>
<div class="dyncontent">
<div class="center"><img src="ws2812_8h__incl.png" border="0" usemap="#include_2ws2812_8h" alt=""/></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="ws2812_8h__dep__incl.png" border="0" usemap="#include_2ws2812_8hdep" alt=""/></div>
</div>
</div>
<p><a href="ws2812_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structws2812__rgb.html">ws2812_rgb</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data structure to hold RGB color values.  <a href="structws2812__rgb.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structws2812__cfg.html">ws2812_cfg</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data structure to configure the WS2812 driver.  <a href="structws2812__cfg.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:aab3d5a3bfdf3fb64fcee6cc5a2518a3a"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structws2812__rgb.html">ws2812_rgb</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812_8h.html#aab3d5a3bfdf3fb64fcee6cc5a2518a3a">ws2812_rgb</a></td></tr>
<tr class="memdesc:aab3d5a3bfdf3fb64fcee6cc5a2518a3a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data structure to hold RGB color values.  <a href="ws2812_8h.html#aab3d5a3bfdf3fb64fcee6cc5a2518a3a">More...</a><br /></td></tr>
<tr class="separator:aab3d5a3bfdf3fb64fcee6cc5a2518a3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add840b3838d91c324bb4388757f48ca6"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structws2812__cfg.html">ws2812_cfg</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812_8h.html#add840b3838d91c324bb4388757f48ca6">ws2812_cfg</a></td></tr>
<tr class="memdesc:add840b3838d91c324bb4388757f48ca6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Data structure to configure the WS2812 driver.  <a href="ws2812_8h.html#add840b3838d91c324bb4388757f48ca6">More...</a><br /></td></tr>
<tr class="separator:add840b3838d91c324bb4388757f48ca6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a8748d3b90dd6acafed50ff0cf34034dd"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812_8h.html#a8748d3b90dd6acafed50ff0cf34034dd">ws2812_order</a> { <br />
&#160;&#160;<b>rgb</b>, 
<b>rbg</b>, 
<b>brg</b>, 
<b>bgr</b>, 
<br />
&#160;&#160;<b>grb</b>, 
<b>gbr</b>
<br />
 }</td></tr>
<tr class="memdesc:a8748d3b90dd6acafed50ff0cf34034dd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enum to tell the driver about the WS2812's color order.  <a href="ws2812_8h.html#a8748d3b90dd6acafed50ff0cf34034dd">More...</a><br /></td></tr>
<tr class="separator:a8748d3b90dd6acafed50ff0cf34034dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abb76184063c2d58324bde5457e32bee0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812_8h.html#abb76184063c2d58324bde5457e32bee0">_ws2812_get_rgbmap</a> (uint8_t(*rgbmap)[3], <a class="el" href="ws2812_8h.html#a8748d3b90dd6acafed50ff0cf34034dd">ws2812_order</a> order)</td></tr>
<tr class="memdesc:abb76184063c2d58324bde5457e32bee0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes a rgb map for a given color order.  <a href="ws2812_8h.html#abb76184063c2d58324bde5457e32bee0">More...</a><br /></td></tr>
<tr class="separator:abb76184063c2d58324bde5457e32bee0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a11328353e3f39c5d6ac1d5d722f2f5f8"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812_8h.html#a11328353e3f39c5d6ac1d5d722f2f5f8">ws2812_config</a> (<a class="el" href="structws2812__cfg.html">ws2812_cfg</a> config)</td></tr>
<tr class="memdesc:a11328353e3f39c5d6ac1d5d722f2f5f8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures the WS2812 driver.  <a href="ws2812_8h.html#a11328353e3f39c5d6ac1d5d722f2f5f8">More...</a><br /></td></tr>
<tr class="separator:a11328353e3f39c5d6ac1d5d722f2f5f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f633e323795ff506acf01b382fa5a00"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812_8h.html#a7f633e323795ff506acf01b382fa5a00">ws2812_prep_tx</a> ()</td></tr>
<tr class="memdesc:a7f633e323795ff506acf01b382fa5a00"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepares the WS2812 driver for data transmission.  <a href="ws2812_8h.html#a7f633e323795ff506acf01b382fa5a00">More...</a><br /></td></tr>
<tr class="separator:a7f633e323795ff506acf01b382fa5a00"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1dfb6194a2f973058d5b932f0d5403fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812_8h.html#a1dfb6194a2f973058d5b932f0d5403fe">ws2812_tx</a> (<a class="el" href="structws2812__rgb.html">ws2812_rgb</a> *pxls, size_t n_pxls)</td></tr>
<tr class="memdesc:a1dfb6194a2f973058d5b932f0d5403fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmits RGB values to the WS2812 strip.  <a href="ws2812_8h.html#a1dfb6194a2f973058d5b932f0d5403fe">More...</a><br /></td></tr>
<tr class="separator:a1dfb6194a2f973058d5b932f0d5403fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af744c4dbfd41c26021af1d5a6cb81ccb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812_8h.html#af744c4dbfd41c26021af1d5a6cb81ccb">ws2812_wait_rst</a> ()</td></tr>
<tr class="memdesc:af744c4dbfd41c26021af1d5a6cb81ccb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Waits for the WS2812 strip to reset.  <a href="ws2812_8h.html#af744c4dbfd41c26021af1d5a6cb81ccb">More...</a><br /></td></tr>
<tr class="separator:af744c4dbfd41c26021af1d5a6cb81ccb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f93fba910a4728f5ccdad630404b5a7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812_8h.html#a3f93fba910a4728f5ccdad630404b5a7">ws2812_close_tx</a> ()</td></tr>
<tr class="memdesc:a3f93fba910a4728f5ccdad630404b5a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes a WS2812 transmission.  <a href="ws2812_8h.html#a3f93fba910a4728f5ccdad630404b5a7">More...</a><br /></td></tr>
<tr class="separator:a3f93fba910a4728f5ccdad630404b5a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Exposes the Tiny-WS2812 driver interface. </p>
<dl class="section author"><dt>Author</dt><dd>Patrick Pedersen </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2021-04-09</dd></dl>
<p>The Tiny-WS2812 driver interface initially derives from the driver code of an open source WS2812 LED controller that I had worked on prior, and provides a nearly barebone interface to communicate with WS2812 LED strips.</p>
<p>The following platforms and frameworks are currently supported:</p><ul>
<li>Barebone AVR</li>
<li>The Arduino Framework (Currently only AVR based (eg. Uno, Leonardo, Micro...))</li>
</ul>
<p>It has been developed out of the necessity to have an extremely light weight and flexible cross-platform driver that can be further abstracted and used troughout my WS2812 projects, particullary on MCUs with severe memory constraints (ex. ATTiny chips), where one cannot just define an RGB array equivalent to the size of the LED strip. This drivers purpose is <b>NOT</b> to provide fancy abstractions and functions for color correction, brightness settings, animations etc.</p>
<p>To summerize, this driver is inteded to:</p><ul>
<li>be used on MCUs with limited computing resources.</li>
<li>act as a base for more abstract WS2812 libraries.</li>
<li>be easily portable to other platforms or programming frameworks (ex. Arduino).</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>Because the motivation of this driver is to be as barebone as possible, it relies on a superficial understanding of the WS2812 protocol and may demand an understanding of the host platforms platform (eg. registers etc.). For quick and simple programming of WS2812 strips, where memory and processing power are not a big issue, other drivers/libraries should probably be consulted. <br  />
 </dd></dl>

<p class="definition">Definition in file <a class="el" href="ws2812_8h_source.html">ws2812.h</a>.</p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a id="add840b3838d91c324bb4388757f48ca6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add840b3838d91c324bb4388757f48ca6">&#9670;&nbsp;</a></span>ws2812_cfg</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structws2812__cfg.html">ws2812_cfg</a> <a class="el" href="structws2812__cfg.html">ws2812_cfg</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Data structure to configure the WS2812 driver. </p>
<p>The following data structure is used to configure the WS2812 driver. It is taken as an argument by the <a class="el" href="ws2812__avr_8c.html#a11328353e3f39c5d6ac1d5d722f2f5f8" title="Configures the WS2812 driver.">ws2812_config()</a> function.</p>
<dl class="section warning"><dt>Warning</dt><dd>All fields of the configuration object must be defined before passing it to <a class="el" href="ws2812__avr_8c.html#a11328353e3f39c5d6ac1d5d722f2f5f8" title="Configures the WS2812 driver.">ws2812_config()</a>! Leaving a field undefined will result in undefined behaivor! </dd></dl>

</div>
</div>
<a id="aab3d5a3bfdf3fb64fcee6cc5a2518a3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab3d5a3bfdf3fb64fcee6cc5a2518a3a">&#9670;&nbsp;</a></span>ws2812_rgb</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structws2812__rgb.html">ws2812_rgb</a> <a class="el" href="structws2812__rgb.html">ws2812_rgb</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Data structure to hold RGB color values. </p>
<p>The RGB struct holds the red, green and blue values to define colors. It is used by the <a class="el" href="ws2812__avr_8c.html#a1dfb6194a2f973058d5b932f0d5403fe" title="Transmits RGB values to the WS2812 strip.">ws2812_tx()</a> function to set the color of one or more WS2812 LEDs.</p>
<dl class="section note"><dt>Note</dt><dd>It should be noted that WS2812 LEDs typically suffer from poor color accuracy. As an example, the typical RGB value for orange (255,165,0) displays a color closer to yellow on my WS2812 strip. <br  />
 </dd></dl>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a8748d3b90dd6acafed50ff0cf34034dd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8748d3b90dd6acafed50ff0cf34034dd">&#9670;&nbsp;</a></span>ws2812_order</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="ws2812_8h.html#a8748d3b90dd6acafed50ff0cf34034dd">ws2812_order</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Enum to tell the driver about the WS2812's color order. </p>
<p>Unfortunately there is no clear standard on sequential color order of WS2812 chips, some are intuitively programmed in RGB order, however, many, if not the majority, of available WS2812 chips are programmed in GRB oder. As there is automatic way to identify the correct color order, it must be manually provided in the driver configuration with this enum. </p>

<p class="definition">Definition at line <a class="el" href="ws2812_8h_source.html#l00088">88</a> of file <a class="el" href="ws2812_8h_source.html">ws2812.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;             {</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        rgb,</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        rbg,</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        brg,</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        bgr,</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        grb,</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        gbr</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;} <a class="code" href="ws2812_8h.html#a8748d3b90dd6acafed50ff0cf34034dd">ws2812_order</a>;</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="abb76184063c2d58324bde5457e32bee0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb76184063c2d58324bde5457e32bee0">&#9670;&nbsp;</a></span>_ws2812_get_rgbmap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void _ws2812_get_rgbmap </td>
          <td>(</td>
          <td class="paramtype">uint8_t(*)&#160;</td>
          <td class="paramname"><em>rgbmap</em>[3], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="ws2812_8h.html#a8748d3b90dd6acafed50ff0cf34034dd">ws2812_order</a>&#160;</td>
          <td class="paramname"><em>order</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initializes a rgb map for a given color order. </p>
<p>The following function is intended only to be used for internal driver code, hence the _ prefix. It fills a 3 element byte array with the necessary offsets to map/convert RGB values to a different color order. For example, setting the order to <code>rgb</code> fills the rgb map with <code>0, 1, 2</code> and <code>bgr</code> fill the rgb map with <code>2, 1, 0</code>, etc. </p>

<p class="definition">Definition at line <a class="el" href="ws2812__common_8c_source.html#l00043">43</a> of file <a class="el" href="ws2812__common_8c_source.html">ws2812_common.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;        <span class="keywordflow">switch</span> (order) {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                <span class="keywordflow">case</span> rbg:</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                        memcpy(rgbmap, ws2812_order_rbg, 3);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                <span class="keywordflow">case</span> brg:</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;                        memcpy(rgbmap, ws2812_order_brg, 3);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;                <span class="keywordflow">case</span> bgr:</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                        memcpy(rgbmap, ws2812_order_bgr, 3);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;                <span class="keywordflow">case</span> grb:</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;                        memcpy(rgbmap, ws2812_order_grb, 3);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;                <span class="keywordflow">case</span> gbr:</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                        memcpy(rgbmap, ws2812_order_gbr, 3);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;                <span class="keywordflow">default</span>: <span class="comment">// rgb</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;                        memcpy(rgbmap, ws2812_order_rgb, 3);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        }</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3f93fba910a4728f5ccdad630404b5a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f93fba910a4728f5ccdad630404b5a7">&#9670;&nbsp;</a></span>ws2812_close_tx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ws2812_close_tx </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes a WS2812 transmission. </p>
<p>The following function should be called after ending data transmission with the WS2812 strip. The exact closing procedure is platform specific but will typically involve restoring stashed registers to their previous states, re-enable interrupts, and wait for the WS2812 to reset by calling <a class="el" href="ws2812_8h.html#af744c4dbfd41c26021af1d5a6cb81ccb" title="Waits for the WS2812 strip to reset.">ws2812_wait_rst()</a>. </p>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8c_source.html#l00270">270</a> of file <a class="el" href="ws2812__avr_8c_source.html">ws2812_avr.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;{</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        SREG = _sreg_prev;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        sei();</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <a class="code" href="ws2812__avr_8c.html#af744c4dbfd41c26021af1d5a6cb81ccb">ws2812_wait_rst</a>();</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a11328353e3f39c5d6ac1d5d722f2f5f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a11328353e3f39c5d6ac1d5d722f2f5f8">&#9670;&nbsp;</a></span>ws2812_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t ws2812_config </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structws2812__cfg.html">ws2812_cfg</a>&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configures the WS2812 driver. </p>
<p>The following function configures various, often platform-specific, parameters of the WS2812 driver. The configured parameters are passed through a <a class="el" href="structws2812__cfg.html" title="Data structure to configure the WS2812 driver.">ws2812_cfg</a> object, and may define attributes such as which pin is used for data transmission, the WS2812 reset time, the WS2812 color order and more... </p>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8c_source.html#l00127">127</a> of file <a class="el" href="ws2812__avr_8c_source.html">ws2812_avr.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;{</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        <span class="keywordflow">if</span> (config.<a class="code" href="structws2812__cfg.html#aa8c9e74284fd4a6440cab54b36969b97">n_strips</a> == 0)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                <span class="keywordflow">return</span> 1; <span class="comment">// No strips to be driven!</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        uint8_t pin_msk = 0;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">#ifdef WS2812_TARGET_PLATFORM_ARDUINO_AVR</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; config.<a class="code" href="structws2812__cfg.html#aa8c9e74284fd4a6440cab54b36969b97">n_strips</a>; i++) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                <span class="keywordflow">if</span> (i+1 &lt; config.<a class="code" href="structws2812__cfg.html#aa8c9e74284fd4a6440cab54b36969b97">n_strips</a> &amp;&amp;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                    digitalPinToPort(config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[i]) != digitalPinToPort(config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[i+1]))</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                        <span class="keywordflow">return</span> 2; <span class="comment">// Pins do not share same port!</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                pinMode(config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[i], OUTPUT);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                pin_msk |= digitalPinToBitMask(config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[i]);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        _port = portOutputRegister(digitalPinToPort(config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[0]));</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; config.<a class="code" href="structws2812__cfg.html#aa8c9e74284fd4a6440cab54b36969b97">n_strips</a>; i++)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                pin_msk |= 1 &lt;&lt; config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[i];</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        *config.<a class="code" href="structws2812__cfg.html#a05c7bc58ea6e94f80e5b4b7f0ab3a554">ddr</a> = pin_msk;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        _port = config.<a class="code" href="structws2812__cfg.html#a68fff035f1137f78fc80e9f9bc0fb831">port</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;#endif</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        _rst_time_us = config.<a class="code" href="structws2812__cfg.html#a9131a1de83995aa8c917e1a3c6ee1fa5">rst_time_us</a>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        _masklo = ~pin_msk &amp; *_port;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        _maskhi = pin_msk | *_port;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <a class="code" href="ws2812__common_8c.html#abb76184063c2d58324bde5457e32bee0">_ws2812_get_rgbmap</a>(&amp;_rgbmap, config.<a class="code" href="structws2812__cfg.html#ad50d0defcc33c93e648889222b93c1aa">order</a>);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f633e323795ff506acf01b382fa5a00"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f633e323795ff506acf01b382fa5a00">&#9670;&nbsp;</a></span>ws2812_prep_tx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ws2812_prep_tx </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepares the WS2812 driver for data transmission. </p>
<p>The following function prepares the WS2812 driver for data transmission. The exact preperation procedure is platform specific, but typically will involve disabling interrupts and stashing registers that may be modified when communicating to the WS2812 strip. For a more detailed understanding, please refer to the platform specific code of this function.</p>
<dl class="section warning"><dt>Warning</dt><dd>Always call this function before making any calls to <a class="el" href="ws2812_8h.html#a1dfb6194a2f973058d5b932f0d5403fe" title="Transmits RGB values to the WS2812 strip.">ws2812_tx()</a>! Not doing so may result in undefined behaivour! </dd></dl>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8c_source.html#l00160">160</a> of file <a class="el" href="ws2812__avr_8c_source.html">ws2812_avr.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;{</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        _sreg_prev = SREG;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        cli();</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1dfb6194a2f973058d5b932f0d5403fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1dfb6194a2f973058d5b932f0d5403fe">&#9670;&nbsp;</a></span>ws2812_tx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ws2812_tx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structws2812__rgb.html">ws2812_rgb</a> *&#160;</td>
          <td class="paramname"><em>pxls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_pxls</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmits RGB values to the WS2812 strip. </p>
<p>The following function transmits RGB values to the WS2812 strip. Calling this function consecutively will continue programming LEDs after the position where the last transmission has ended. In other words, calling the function consecutively will <b>NOT</b> program the strip from the first LED, but rather take off from where it last ended. If this is not desired, call <a class="el" href="ws2812_8h.html#af744c4dbfd41c26021af1d5a6cb81ccb" title="Waits for the WS2812 strip to reset.">ws2812_wait_rst()</a> after each transmission.</p>
<dl class="section warning"><dt>Warning</dt><dd>Transmissions must take place consecutively. Should there be too great of a delay between transmission calls, the strip WS2812s reset time will expire, causing the strip to be programmed from the first LED again. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8c_source.html#l00259">259</a> of file <a class="el" href="ws2812__avr_8c_source.html">ws2812_avr.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;{</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n_pxls; i++) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                <span class="keywordflow">for</span> (uint8_t j = 0; j &lt; <span class="keyword">sizeof</span>(_rgbmap); j++) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                        uint8_t *pxl = (uint8_t *) &amp;(pxls[i]);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                        <a class="code" href="ws2812__avr_8c.html#aa2765b88e48dfab707140c489e3afe31">ws2812_tx_byte</a>(pxl[_rgbmap[j]]);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af744c4dbfd41c26021af1d5a6cb81ccb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af744c4dbfd41c26021af1d5a6cb81ccb">&#9670;&nbsp;</a></span>ws2812_wait_rst()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ws2812_wait_rst </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Waits for the WS2812 strip to reset. </p>
<p>The following function waits for the WS2812 strip to reset, thus allowing it to be overwritten from the first LED again. The reset time is set in the <a class="el" href="structws2812__cfg.html" title="Data structure to configure the WS2812 driver.">ws2812_cfg</a> object and is recommended to be 50us according to the WS2812 datasheet, but may be set significantly lower for some strips. Call this function if you wish to overwritte the LED strip after a previous <a class="el" href="ws2812_8h.html#a1dfb6194a2f973058d5b932f0d5403fe" title="Transmits RGB values to the WS2812 strip.">ws2812_tx()</a> call.</p>
<dl class="section note"><dt>Note</dt><dd>This function does not have to be called prior calling #ws2812_end_tx() as it already contains a call to <a class="el" href="ws2812_8h.html#af744c4dbfd41c26021af1d5a6cb81ccb" title="Waits for the WS2812 strip to reset.">ws2812_wait_rst()</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8c_source.html#l00167">167</a> of file <a class="el" href="ws2812__avr_8c_source.html">ws2812_avr.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;{</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="preprocessor">#ifdef WS2812_TARGET_PLATFORM_ARDUINO_AVR</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        delayMicroseconds(_rst_time_us);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <a class="code" href="ws2812__avr_8c.html#a8069aef456aba6f66b80ac92a4746a32">delay_us</a>(_rst_time_us);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<div class="ttc" id="astructws2812__cfg_html_a9131a1de83995aa8c917e1a3c6ee1fa5"><div class="ttname"><a href="structws2812__cfg.html#a9131a1de83995aa8c917e1a3c6ee1fa5">ws2812_cfg::rst_time_us</a></div><div class="ttdeci">uint8_t rst_time_us</div><div class="ttdoc">Time required for WS2812 to reset in us.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812_8h_source.html#l00139">ws2812.h:139</a></div></div>
<div class="ttc" id="aws2812__avr_8c_html_a8069aef456aba6f66b80ac92a4746a32"><div class="ttname"><a href="ws2812__avr_8c.html#a8069aef456aba6f66b80ac92a4746a32">delay_us</a></div><div class="ttdeci">void delay_us(uint8_t us)</div><div class="ttdoc">Halts the program for a given ammount of microseconds.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8c_source.html#l00117">ws2812_avr.c:117</a></div></div>
<div class="ttc" id="aws2812__avr_8c_html_aa2765b88e48dfab707140c489e3afe31"><div class="ttname"><a href="ws2812__avr_8c.html#aa2765b88e48dfab707140c489e3afe31">ws2812_tx_byte</a></div><div class="ttdeci">void ws2812_tx_byte(uint8_t byte)</div><div class="ttdoc">Transmits a byte of data to the WS2812 strip.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8c_source.html#l00189">ws2812_avr.c:189</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_a68fff035f1137f78fc80e9f9bc0fb831"><div class="ttname"><a href="structws2812__cfg.html#a68fff035f1137f78fc80e9f9bc0fb831">ws2812_cfg::port</a></div><div class="ttdeci">volatile uint8_t * port</div><div class="ttdoc">PORT Register (ex. PORTB, PORTC, PORTD...)</div><div class="ttdef"><b>Definition:</b> <a href="ws2812_8h_source.html#l00127">ws2812.h:127</a></div></div>
<div class="ttc" id="aws2812_8h_html_a8748d3b90dd6acafed50ff0cf34034dd"><div class="ttname"><a href="ws2812_8h.html#a8748d3b90dd6acafed50ff0cf34034dd">ws2812_order</a></div><div class="ttdeci">ws2812_order</div><div class="ttdoc">Enum to tell the driver about the WS2812's color order.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812_8h_source.html#l00088">ws2812.h:88</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_ae4f693b8495942acae05da3df3bcfa58"><div class="ttname"><a href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">ws2812_cfg::pins</a></div><div class="ttdeci">uint8_t * pins</div><div class="ttdoc">Array of pins used to program WS2812 strips (Must share the same PORT! (ex. PB0, PB1,...</div><div class="ttdef"><b>Definition:</b> <a href="ws2812_8h_source.html#l00129">ws2812.h:129</a></div></div>
<div class="ttc" id="aws2812__common_8c_html_abb76184063c2d58324bde5457e32bee0"><div class="ttname"><a href="ws2812__common_8c.html#abb76184063c2d58324bde5457e32bee0">_ws2812_get_rgbmap</a></div><div class="ttdeci">void _ws2812_get_rgbmap(uint8_t(*rgbmap)[3], ws2812_order order)</div><div class="ttdoc">Initializes a rgb map for a given color order.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__common_8c_source.html#l00043">ws2812_common.c:43</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_ad50d0defcc33c93e648889222b93c1aa"><div class="ttname"><a href="structws2812__cfg.html#ad50d0defcc33c93e648889222b93c1aa">ws2812_cfg::order</a></div><div class="ttdeci">ws2812_order order</div><div class="ttdoc">Color order (ex. rgb, grb, bgr...)</div><div class="ttdef"><b>Definition:</b> <a href="ws2812_8h_source.html#l00140">ws2812.h:140</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_a05c7bc58ea6e94f80e5b4b7f0ab3a554"><div class="ttname"><a href="structws2812__cfg.html#a05c7bc58ea6e94f80e5b4b7f0ab3a554">ws2812_cfg::ddr</a></div><div class="ttdeci">volatile uint8_t * ddr</div><div class="ttdoc">Data Direction Register (ex. DDRB, DDRC, DDRD...)</div><div class="ttdef"><b>Definition:</b> <a href="ws2812_8h_source.html#l00128">ws2812.h:128</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_aa8c9e74284fd4a6440cab54b36969b97"><div class="ttname"><a href="structws2812__cfg.html#aa8c9e74284fd4a6440cab54b36969b97">ws2812_cfg::n_strips</a></div><div class="ttdeci">uint8_t n_strips</div><div class="ttdoc">Number of pins used used to program WS2812 strips.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812_8h_source.html#l00130">ws2812.h:130</a></div></div>
<div class="ttc" id="aws2812__avr_8c_html_af744c4dbfd41c26021af1d5a6cb81ccb"><div class="ttname"><a href="ws2812__avr_8c.html#af744c4dbfd41c26021af1d5a6cb81ccb">ws2812_wait_rst</a></div><div class="ttdeci">void ws2812_wait_rst()</div><div class="ttdoc">Waits for the WS2812 strip to reset.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8c_source.html#l00167">ws2812_avr.c:167</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
