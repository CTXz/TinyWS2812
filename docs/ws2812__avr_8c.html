<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Tiny-WS2812: src/ws2812_avr.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Tiny-WS2812
   &#160;<span id="projectnumber">1.0.0</span>
   </div>
   <div id="projectbrief">A tiny cross-platform WS2812 LED Strip driver</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">ws2812_avr.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Driver code for AVR chips.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdint.h&gt;</code><br />
<code>#include &lt;stdbool.h&gt;</code><br />
<code>#include &lt;avr/interrupt.h&gt;</code><br />
<code>#include &lt;avr/io.h&gt;</code><br />
<code>#include &lt;util/delay.h&gt;</code><br />
<code>#include &lt;<a class="el" href="ws2812_8h_source.html">ws2812.h</a>&gt;</code><br />
<code>#include &lt;Arduino.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ws2812_avr.c:</div>
<div class="dyncontent">
<div class="center"><img src="ws2812__avr_8c__incl.png" border="0" usemap="#src_2ws2812__avr_8c" alt=""/></div>
</div>
</div>
<p><a href="ws2812__avr_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a499eb829fa8335b41171cb8d2086a4f1"><td class="memItemLeft" align="right" valign="top"><a id="a499eb829fa8335b41171cb8d2086a4f1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w_zeropulse</b>&#160;&#160;&#160;350</td></tr>
<tr class="separator:a499eb829fa8335b41171cb8d2086a4f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bd9c35ce0f1aa812400bf2ac0f8ce0f"><td class="memItemLeft" align="right" valign="top"><a id="a9bd9c35ce0f1aa812400bf2ac0f8ce0f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w_onepulse</b>&#160;&#160;&#160;900</td></tr>
<tr class="separator:a9bd9c35ce0f1aa812400bf2ac0f8ce0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ebb9c7ddf91c559a0e773d6622c74a1"><td class="memItemLeft" align="right" valign="top"><a id="a0ebb9c7ddf91c559a0e773d6622c74a1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w_totalperiod</b>&#160;&#160;&#160;1250</td></tr>
<tr class="separator:a0ebb9c7ddf91c559a0e773d6622c74a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af20eba0af4c1b15aefa464046143f034"><td class="memItemLeft" align="right" valign="top"><a id="af20eba0af4c1b15aefa464046143f034"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w_fixedlow</b>&#160;&#160;&#160;3</td></tr>
<tr class="separator:af20eba0af4c1b15aefa464046143f034"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a099460b796ac2b7e76147c6f758a14"><td class="memItemLeft" align="right" valign="top"><a id="a8a099460b796ac2b7e76147c6f758a14"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w_fixedhigh</b>&#160;&#160;&#160;6</td></tr>
<tr class="separator:a8a099460b796ac2b7e76147c6f758a14"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5490c5f9163305e8f9a7501dbe07229c"><td class="memItemLeft" align="right" valign="top"><a id="a5490c5f9163305e8f9a7501dbe07229c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w_fixedtotal</b>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a5490c5f9163305e8f9a7501dbe07229c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb14eacbb2299b20dfa3bc2077364105"><td class="memItemLeft" align="right" valign="top"><a id="afb14eacbb2299b20dfa3bc2077364105"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w_zerocycles</b>&#160;&#160;&#160;(((F_CPU/1000)*w_zeropulse          )/1000000)</td></tr>
<tr class="separator:afb14eacbb2299b20dfa3bc2077364105"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff1eab374127b1be034e91ec47d60747"><td class="memItemLeft" align="right" valign="top"><a id="aff1eab374127b1be034e91ec47d60747"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w_onecycles</b>&#160;&#160;&#160;(((F_CPU/1000)*w_onepulse    +500000)/1000000)</td></tr>
<tr class="separator:aff1eab374127b1be034e91ec47d60747"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a137933b78ddd218d52345042fbd610cb"><td class="memItemLeft" align="right" valign="top"><a id="a137933b78ddd218d52345042fbd610cb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w_totalcycles</b>&#160;&#160;&#160;(((F_CPU/1000)*w_totalperiod +500000)/1000000)</td></tr>
<tr class="separator:a137933b78ddd218d52345042fbd610cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab7c774e5d2496f420e70b067f5d2ae4"><td class="memItemLeft" align="right" valign="top"><a id="aab7c774e5d2496f420e70b067f5d2ae4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w1</b>&#160;&#160;&#160;(w_zerocycles-w_fixedlow)</td></tr>
<tr class="separator:aab7c774e5d2496f420e70b067f5d2ae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e2c02ff5e8c641967d763af0e76ac4b"><td class="memItemLeft" align="right" valign="top"><a id="a4e2c02ff5e8c641967d763af0e76ac4b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w2</b>&#160;&#160;&#160;(w_onecycles-w_fixedhigh-w1)</td></tr>
<tr class="separator:a4e2c02ff5e8c641967d763af0e76ac4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abeac6c0f86a7a600eca940f4921d2fc9"><td class="memItemLeft" align="right" valign="top"><a id="abeac6c0f86a7a600eca940f4921d2fc9"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w3</b>&#160;&#160;&#160;(w_totalcycles-w_fixedtotal-w1-w2)</td></tr>
<tr class="separator:abeac6c0f86a7a600eca940f4921d2fc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac30fa3b0d4061d6c165ff4cc132dae77"><td class="memItemLeft" align="right" valign="top"><a id="ac30fa3b0d4061d6c165ff4cc132dae77"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w1_nops</b>&#160;&#160;&#160;0</td></tr>
<tr class="separator:ac30fa3b0d4061d6c165ff4cc132dae77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a051b080f46f4d448ad15c9d90e071164"><td class="memItemLeft" align="right" valign="top"><a id="a051b080f46f4d448ad15c9d90e071164"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w_lowtime</b>&#160;&#160;&#160;((w1_nops+w_fixedlow)*1000000)/(F_CPU/1000)</td></tr>
<tr class="separator:a051b080f46f4d448ad15c9d90e071164"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac92cbe7ea3e50cf600803405e1be9cdf"><td class="memItemLeft" align="right" valign="top"><a id="ac92cbe7ea3e50cf600803405e1be9cdf"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w2_nops</b>&#160;&#160;&#160;0</td></tr>
<tr class="separator:ac92cbe7ea3e50cf600803405e1be9cdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaa81c7920b7f846931a4a42f56bd5d7"><td class="memItemLeft" align="right" valign="top"><a id="acaa81c7920b7f846931a4a42f56bd5d7"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w3_nops</b>&#160;&#160;&#160;0</td></tr>
<tr class="separator:acaa81c7920b7f846931a4a42f56bd5d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30b25d9663fb770ec37b510236efe8c3"><td class="memItemLeft" align="right" valign="top"><a id="a30b25d9663fb770ec37b510236efe8c3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w_nop1</b>&#160;&#160;&#160;&quot;nop      \n\t&quot;</td></tr>
<tr class="separator:a30b25d9663fb770ec37b510236efe8c3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86304537221750510ec329ad47d0fe42"><td class="memItemLeft" align="right" valign="top"><a id="a86304537221750510ec329ad47d0fe42"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w_nop2</b>&#160;&#160;&#160;&quot;rjmp .+0 \n\t&quot;</td></tr>
<tr class="separator:a86304537221750510ec329ad47d0fe42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b4d85cace31e767d9518e45792f758b"><td class="memItemLeft" align="right" valign="top"><a id="a9b4d85cace31e767d9518e45792f758b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w_nop4</b>&#160;&#160;&#160;w_nop2 w_nop2</td></tr>
<tr class="separator:a9b4d85cace31e767d9518e45792f758b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae116e656e5797377e20ec301a4378a8f"><td class="memItemLeft" align="right" valign="top"><a id="ae116e656e5797377e20ec301a4378a8f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w_nop8</b>&#160;&#160;&#160;w_nop4 w_nop4</td></tr>
<tr class="separator:ae116e656e5797377e20ec301a4378a8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8652e9038d96a20508833c08695f78e3"><td class="memItemLeft" align="right" valign="top"><a id="a8652e9038d96a20508833c08695f78e3"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>w_nop16</b>&#160;&#160;&#160;w_nop8 w_nop8</td></tr>
<tr class="separator:a8652e9038d96a20508833c08695f78e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8069aef456aba6f66b80ac92a4746a32"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812__avr_8c.html#a8069aef456aba6f66b80ac92a4746a32">delay_us</a> (uint8_t us)</td></tr>
<tr class="memdesc:a8069aef456aba6f66b80ac92a4746a32"><td class="mdescLeft">&#160;</td><td class="mdescRight">Halts the program for a given ammount of microseconds.  <a href="ws2812__avr_8c.html#a8069aef456aba6f66b80ac92a4746a32">More...</a><br /></td></tr>
<tr class="separator:a8069aef456aba6f66b80ac92a4746a32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad08c3092fa4ac89001493828d5a4665d"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812__avr_8c.html#ad08c3092fa4ac89001493828d5a4665d">ws2812_config</a> (<a class="el" href="structws2812.html">ws2812</a> *dev, <a class="el" href="structws2812__cfg.html">ws2812_cfg</a> config)</td></tr>
<tr class="memdesc:ad08c3092fa4ac89001493828d5a4665d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Configures a <a class="el" href="structws2812.html">WS2812 device struct</a>.  <a href="ws2812__avr_8c.html#ad08c3092fa4ac89001493828d5a4665d">More...</a><br /></td></tr>
<tr class="separator:ad08c3092fa4ac89001493828d5a4665d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ac53e8d64e1fc6073e85ea0fd80a975"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812__avr_8c.html#a8ac53e8d64e1fc6073e85ea0fd80a975">ws2812_prep_tx</a> (<a class="el" href="structws2812.html">ws2812</a> *dev)</td></tr>
<tr class="memdesc:a8ac53e8d64e1fc6073e85ea0fd80a975"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepares the driver for data transmission.  <a href="ws2812__avr_8c.html#a8ac53e8d64e1fc6073e85ea0fd80a975">More...</a><br /></td></tr>
<tr class="separator:a8ac53e8d64e1fc6073e85ea0fd80a975"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2eb0bca405f4e5cffbed88230fd35038"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812__avr_8c.html#a2eb0bca405f4e5cffbed88230fd35038">ws2812_wait_rst</a> (<a class="el" href="structws2812.html">ws2812</a> *dev)</td></tr>
<tr class="memdesc:a2eb0bca405f4e5cffbed88230fd35038"><td class="mdescLeft">&#160;</td><td class="mdescRight">Waits for the <a class="el" href="structws2812.html">WS2812 device</a> to reset.  <a href="ws2812__avr_8c.html#a2eb0bca405f4e5cffbed88230fd35038">More...</a><br /></td></tr>
<tr class="separator:a2eb0bca405f4e5cffbed88230fd35038"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae286d1f394d345649b3ad08404fcfed5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812__avr_8c.html#ae286d1f394d345649b3ad08404fcfed5">ws2812_tx_byte</a> (<a class="el" href="structws2812.html">ws2812</a> *dev, uint8_t byte)</td></tr>
<tr class="memdesc:ae286d1f394d345649b3ad08404fcfed5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmits a byte of data to the <a class="el" href="structws2812.html">WS2812 device</a>.  <a href="ws2812__avr_8c.html#ae286d1f394d345649b3ad08404fcfed5">More...</a><br /></td></tr>
<tr class="separator:ae286d1f394d345649b3ad08404fcfed5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2db6a7db2e9f0a57921b01037202e15"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812__avr_8c.html#af2db6a7db2e9f0a57921b01037202e15">ws2812_tx</a> (<a class="el" href="structws2812.html">ws2812</a> *dev, <a class="el" href="structws2812__rgb.html">ws2812_rgb</a> *pxls, size_t n_pxls)</td></tr>
<tr class="memdesc:af2db6a7db2e9f0a57921b01037202e15"><td class="mdescLeft">&#160;</td><td class="mdescRight">Transmits RGB values to the provided <a class="el" href="structws2812.html">WS2812 device</a>.  <a href="ws2812__avr_8c.html#af2db6a7db2e9f0a57921b01037202e15">More...</a><br /></td></tr>
<tr class="separator:af2db6a7db2e9f0a57921b01037202e15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c2ce6b9d36f5c768bfdd781812aea34"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ws2812__avr_8c.html#a0c2ce6b9d36f5c768bfdd781812aea34">ws2812_close_tx</a> (<a class="el" href="structws2812.html">ws2812</a> *dev)</td></tr>
<tr class="memdesc:a0c2ce6b9d36f5c768bfdd781812aea34"><td class="mdescLeft">&#160;</td><td class="mdescRight">Closes a WS2812 transmission.  <a href="ws2812__avr_8c.html#a0c2ce6b9d36f5c768bfdd781812aea34">More...</a><br /></td></tr>
<tr class="separator:a0c2ce6b9d36f5c768bfdd781812aea34"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Driver code for AVR chips. </p>
<dl class="section author"><dt>Author</dt><dd>Patrick Pedersen </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2021-04-09</dd></dl>
<p>The following file holds the Tiny-WS2812 driver code for AVR chips. </p>

<p class="definition">Definition in file <a class="el" href="ws2812__avr_8c_source.html">ws2812_avr.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a8069aef456aba6f66b80ac92a4746a32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8069aef456aba6f66b80ac92a4746a32">&#9670;&nbsp;</a></span>delay_us()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void delay_us </td>
          <td>(</td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>us</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Halts the program for a given ammount of microseconds. </p>
<p>The following function temporarily disables interrupts and pauses the program code for a provided ammount of microseconds (max 255).</p>
<dl class="section warning"><dt>Warning</dt><dd>This function relies on the _delay_us() function, which reserves the CPU from performing any other tasks. </dd>
<dd>
Since the for loop of this function also requires time to be executed, the actual delay will always be slighly longer. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8c_source.html#l00115">115</a> of file <a class="el" href="ws2812__avr_8c_source.html">ws2812_avr.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        cli();</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; us; i++)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                _delay_us(1);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        sei();</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c2ce6b9d36f5c768bfdd781812aea34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c2ce6b9d36f5c768bfdd781812aea34">&#9670;&nbsp;</a></span>ws2812_close_tx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ws2812_close_tx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structws2812.html">ws2812</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Closes a WS2812 transmission. </p>
<p>The following function should be called after ending data transmission with a WS2812 device. The exact closing procedure is platform specific but will typically involve restoring stashed registers to their previous states, re-enable interrupts, wait for the WS2812 to reset by calling <a class="el" href="ws2812_8h.html#a2eb0bca405f4e5cffbed88230fd35038" title="Waits for the WS2812 device to reset.">ws2812_wait_rst()</a>, and potentially alter fields of the provided <a class="el" href="structws2812.html">WS2812 device struct</a>. </p>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8c_source.html#l00271">271</a> of file <a class="el" href="ws2812__avr_8c_source.html">ws2812_avr.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;{</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">if</span> (_prep == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                SREG = _sreg_prev;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                sei();</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                _prep = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                <a class="code" href="ws2812__avr_8c.html#a2eb0bca405f4e5cffbed88230fd35038">ws2812_wait_rst</a>(dev);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad08c3092fa4ac89001493828d5a4665d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad08c3092fa4ac89001493828d5a4665d">&#9670;&nbsp;</a></span>ws2812_config()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t ws2812_config </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structws2812.html">ws2812</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structws2812__cfg.html">ws2812_cfg</a>&#160;</td>
          <td class="paramname"><em>config</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Configures a <a class="el" href="structws2812.html">WS2812 device struct</a>. </p>
<p>The following function initializes/configures a <a class="el" href="structws2812.html">WS2812 device struct</a> using a <a class="el" href="structws2812__cfg.html">ws2812_cfg configuration struct</a>. </p>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8c_source.html#l00125">125</a> of file <a class="el" href="ws2812__avr_8c_source.html">ws2812_avr.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;{</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">if</span> (config.<a class="code" href="structws2812__cfg.html#a2a6404a5d1e6d8829e2abcf5d916715b">n_dev</a> == 0)</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                <span class="keywordflow">return</span> 1; <span class="comment">// No devices to be driven!</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        uint8_t pin_msk = 0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="preprocessor">#ifdef WS2812_TARGET_PLATFORM_ARDUINO_AVR</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; config.<a class="code" href="structws2812__cfg.html#a2a6404a5d1e6d8829e2abcf5d916715b">n_dev</a>; i++) {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                <span class="keywordflow">if</span> (i+1 &lt; config.<a class="code" href="structws2812__cfg.html#a2a6404a5d1e6d8829e2abcf5d916715b">n_dev</a> &amp;&amp;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                    digitalPinToPort(config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[i]) != digitalPinToPort(config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[i+1]))</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                        <span class="keywordflow">return</span> 2; <span class="comment">// Pins do not share same port!</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                pinMode(config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[i], OUTPUT);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                pin_msk |= digitalPinToBitMask(config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[i]);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        dev-&gt;<a class="code" href="structws2812.html#af8a9e3c5bbc7cd936d94ad33bca218dd">port</a> = portOutputRegister(digitalPinToPort(config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[0]));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; config.<a class="code" href="structws2812__cfg.html#a2a6404a5d1e6d8829e2abcf5d916715b">n_dev</a>; i++)</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                pin_msk |= 1 &lt;&lt; config.<a class="code" href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">pins</a>[i];</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        *config.<a class="code" href="structws2812__cfg.html#a05c7bc58ea6e94f80e5b4b7f0ab3a554">ddr</a> = pin_msk;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        dev-&gt;<a class="code" href="structws2812.html#af8a9e3c5bbc7cd936d94ad33bca218dd">port</a> = config.<a class="code" href="structws2812__cfg.html#a68fff035f1137f78fc80e9f9bc0fb831">port</a>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;#endif</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        dev-&gt;<a class="code" href="structws2812.html#aac098f9c6f0f802c066122e0166d6970">rst_time_us</a> = config.<a class="code" href="structws2812__cfg.html#a9131a1de83995aa8c917e1a3c6ee1fa5">rst_time_us</a>;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        dev-&gt;<a class="code" href="structws2812.html#ad04d92a4b1276fbb588960ad009b67b9">masklo</a> = ~pin_msk &amp; *(dev-&gt;<a class="code" href="structws2812.html#af8a9e3c5bbc7cd936d94ad33bca218dd">port</a>);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        dev-&gt;<a class="code" href="structws2812.html#ae191c20dea8f9cca0bb92e9d0431f721">maskhi</a> = pin_msk | *(dev-&gt;<a class="code" href="structws2812.html#af8a9e3c5bbc7cd936d94ad33bca218dd">port</a>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <a class="code" href="ws2812__common_8c.html#abb76184063c2d58324bde5457e32bee0">_ws2812_get_rgbmap</a>(&amp;dev-&gt;<a class="code" href="structws2812.html#a8d961104f06a5bd3f8109f0b6a89f142">rgbmap</a>, config.<a class="code" href="structws2812__cfg.html#ad50d0defcc33c93e648889222b93c1aa">order</a>);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ac53e8d64e1fc6073e85ea0fd80a975"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ac53e8d64e1fc6073e85ea0fd80a975">&#9670;&nbsp;</a></span>ws2812_prep_tx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ws2812_prep_tx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structws2812.html">ws2812</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepares the driver for data transmission. </p>
<p>The following function prepares the driver for data transmission. The exact preperation procedure is platform specific, but typically will involve disabling interrupts, stashing registers that may be modified when communicating to the WS2812 device and potentially preparing the passed <a class="el" href="structws2812.html">WS2812 device struct</a> for data transmission. For a more detailed understanding, please refer to the platform specific code of this function.</p>
<dl class="section warning"><dt>Warning</dt><dd>Always call this function before making any calls to <a class="el" href="ws2812_8h.html#af2db6a7db2e9f0a57921b01037202e15" title="Transmits RGB values to the provided WS2812 device.">ws2812_tx()</a>! Not doing so may result in undefined behaivour! </dd></dl>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8c_source.html#l00158">158</a> of file <a class="el" href="ws2812__avr_8c_source.html">ws2812_avr.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;{</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">if</span> (_prep == <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                _sreg_prev = SREG;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                cli();</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                _prep = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        }</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af2db6a7db2e9f0a57921b01037202e15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2db6a7db2e9f0a57921b01037202e15">&#9670;&nbsp;</a></span>ws2812_tx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ws2812_tx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structws2812.html">ws2812</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structws2812__rgb.html">ws2812_rgb</a> *&#160;</td>
          <td class="paramname"><em>pxls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>n_pxls</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmits RGB values to the provided <a class="el" href="structws2812.html">WS2812 device</a>. </p>
<p>The following function transmits RGB values to the provided <a class="el" href="structws2812.html">WS2812 device</a>. Calling this function consecutively for the same device will continue programming LEDs after the position where the last transmission has ended. In other words, calling the function consecutively for the same device will <b>NOT</b> program the device from the first LED, but rather take off from where it last ended. If this is not desired, call <a class="el" href="ws2812_8h.html#a2eb0bca405f4e5cffbed88230fd35038" title="Waits for the WS2812 device to reset.">ws2812_wait_rst()</a> after each transmission. </p>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8c_source.html#l00260">260</a> of file <a class="el" href="ws2812__avr_8c_source.html">ws2812_avr.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;{</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; n_pxls; i++) {</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                <span class="keywordflow">for</span> (uint8_t j = 0; j &lt; <span class="keyword">sizeof</span>(dev-&gt;<a class="code" href="structws2812.html#a8d961104f06a5bd3f8109f0b6a89f142">rgbmap</a>); j++) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                        uint8_t *pxl = (uint8_t *) &amp;(pxls[i]);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                        <a class="code" href="ws2812__avr_8c.html#ae286d1f394d345649b3ad08404fcfed5">ws2812_tx_byte</a>(dev, pxl[dev-&gt;<a class="code" href="structws2812.html#a8d961104f06a5bd3f8109f0b6a89f142">rgbmap</a>[j]]);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        }</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae286d1f394d345649b3ad08404fcfed5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae286d1f394d345649b3ad08404fcfed5">&#9670;&nbsp;</a></span>ws2812_tx_byte()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ws2812_tx_byte </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structws2812.html">ws2812</a> *&#160;</td>
          <td class="paramname"><em>dev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>byte</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Transmits a byte of data to the <a class="el" href="structws2812.html">WS2812 device</a>. </p>
<p>The following function transmits a single byte of data to the provided <a class="el" href="structws2812.html">WS2812 device</a>. It is primarily based on the driver code of <a href="https://github.com/cpldcpu/light_ws2812">cpldcpu's light_ws2812</a> library and achieves precisely timed communication with the WS2812 device through inline AVR assembly code. </p>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8c_source.html#l00190">190</a> of file <a class="el" href="ws2812__avr_8c_source.html">ws2812_avr.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;{</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        uint8_t ctr;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keyword">asm</span> <span class="keyword">volatile</span>(</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <span class="stringliteral">&quot;       ldi   %0,8  \n\t&quot;</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                <span class="stringliteral">&quot;loop%=:            \n\t&quot;</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                <span class="stringliteral">&quot;       st    X,%3 \n\t&quot;</span>    <span class="comment">//  &#39;1&#39; [02] &#39;0&#39; [02] - re</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">                #if (w1_nops&amp;1)</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                w_nop1</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">                #if (w1_nops&amp;2)</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                w_nop2</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="preprocessor">                #if (w1_nops&amp;4)</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                w_nop4</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="preprocessor">                #if (w1_nops&amp;8)</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                w_nop8</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="preprocessor">                #if (w1_nops&amp;16)</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                w_nop16</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                <span class="stringliteral">&quot;       sbrs  %1,7  \n\t&quot;</span>    <span class="comment">//  &#39;1&#39; [04] &#39;0&#39; [03]</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                <span class="stringliteral">&quot;       st    X,%4 \n\t&quot;</span>     <span class="comment">//  &#39;1&#39; [--] &#39;0&#39; [05] - fe-low</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                <span class="stringliteral">&quot;       lsl   %1    \n\t&quot;</span>    <span class="comment">//  &#39;1&#39; [05] &#39;0&#39; [06]</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">                #if (w2_nops&amp;1)</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                w_nop1</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor">                #if (w2_nops&amp;2)</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                w_nop2</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">                #if (w2_nops&amp;4)</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                w_nop4</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="preprocessor">                #if (w2_nops&amp;8)</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                w_nop8</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">                #if (w2_nops&amp;16)</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                w_nop16 </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                <span class="stringliteral">&quot;       brcc skipone%= \n\t&quot;</span>    <span class="comment">//  &#39;1&#39; [+1] &#39;0&#39; [+2] - </span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                <span class="stringliteral">&quot;       st   X,%4      \n\t&quot;</span>    <span class="comment">//  &#39;1&#39; [+3] &#39;0&#39; [--] - fe-high</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                <span class="stringliteral">&quot;skipone%=:               &quot;</span>     <span class="comment">//  &#39;1&#39; [+3] &#39;0&#39; [+2] - </span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">                #if (w3_nops&amp;1)</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                w_nop1</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="preprocessor">                #if (w3_nops&amp;2)</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                w_nop2</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="preprocessor">                #if (w3_nops&amp;4)</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                w_nop4</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">                #if (w3_nops&amp;8)</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                w_nop8</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="preprocessor">                #if (w3_nops&amp;16)</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                w_nop16</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="preprocessor">                #endif</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                <span class="stringliteral">&quot;       dec   %0    \n\t&quot;</span>    <span class="comment">//  &#39;1&#39; [+4] &#39;0&#39; [+3]</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                <span class="stringliteral">&quot;       brne  loop%=\n\t&quot;</span>    <span class="comment">//  &#39;1&#39; [+5] &#39;0&#39; [+4]</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                :   <span class="stringliteral">&quot;=&amp;d&quot;</span> (ctr)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                :   <span class="stringliteral">&quot;r&quot;</span> (<span class="keywordtype">byte</span>), <span class="stringliteral">&quot;x&quot;</span> ((uint8_t *) dev-&gt;<a class="code" href="structws2812.html#af8a9e3c5bbc7cd936d94ad33bca218dd">port</a>), <span class="stringliteral">&quot;r&quot;</span> (dev-&gt;<a class="code" href="structws2812.html#ae191c20dea8f9cca0bb92e9d0431f721">maskhi</a>), <span class="stringliteral">&quot;r&quot;</span> (dev-&gt;<a class="code" href="structws2812.html#ad04d92a4b1276fbb588960ad009b67b9">masklo</a>)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        );</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2eb0bca405f4e5cffbed88230fd35038"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2eb0bca405f4e5cffbed88230fd35038">&#9670;&nbsp;</a></span>ws2812_wait_rst()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ws2812_wait_rst </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structws2812.html">ws2812</a> *&#160;</td>
          <td class="paramname"><em>dev</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Waits for the <a class="el" href="structws2812.html">WS2812 device</a> to reset. </p>
<p>The following function waits for the <a class="el" href="structws2812.html">WS2812 device</a> to reset, thus allowing it to be overwritten from the first LED again. The reset time is configuredin the <a class="el" href="structws2812__cfg.html" title="Data structure to configure a WS2812 device struct on AVR platforms.">ws2812_cfg</a> object used to initialize/configure the passed <a class="el" href="structws2812.html">WS2812 device struct</a>, and is recommended to be 50us according to the WS2812 datasheet, but may be set significantly lower for some WS2812 devices. Call this function if you wish to overwritte the WS2812 device after a previous <a class="el" href="ws2812_8h.html#af2db6a7db2e9f0a57921b01037202e15" title="Transmits RGB values to the provided WS2812 device.">ws2812_tx()</a> call.</p>
<dl class="section note"><dt>Note</dt><dd>This function does not have to be called prior calling #ws2812_end_tx() as it already contains a call to <a class="el" href="ws2812_8h.html#a2eb0bca405f4e5cffbed88230fd35038" title="Waits for the WS2812 device to reset.">ws2812_wait_rst()</a>. </dd></dl>

<p class="definition">Definition at line <a class="el" href="ws2812__avr_8c_source.html#l00168">168</a> of file <a class="el" href="ws2812__avr_8c_source.html">ws2812_avr.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;{</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#ifdef WS2812_TARGET_PLATFORM_ARDUINO_AVR</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        delayMicroseconds(dev-&gt;<a class="code" href="structws2812.html#aac098f9c6f0f802c066122e0166d6970">rst_time_us</a>);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <a class="code" href="ws2812__avr_8c.html#a8069aef456aba6f66b80ac92a4746a32">delay_us</a>(dev-&gt;<a class="code" href="structws2812.html#aac098f9c6f0f802c066122e0166d6970">rst_time_us</a>);</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<div class="ttc" id="aws2812__avr_8c_html_a2eb0bca405f4e5cffbed88230fd35038"><div class="ttname"><a href="ws2812__avr_8c.html#a2eb0bca405f4e5cffbed88230fd35038">ws2812_wait_rst</a></div><div class="ttdeci">void ws2812_wait_rst(ws2812 *dev)</div><div class="ttdoc">Waits for the WS2812 device to reset.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8c_source.html#l00168">ws2812_avr.c:168</a></div></div>
<div class="ttc" id="aws2812__avr_8c_html_ae286d1f394d345649b3ad08404fcfed5"><div class="ttname"><a href="ws2812__avr_8c.html#ae286d1f394d345649b3ad08404fcfed5">ws2812_tx_byte</a></div><div class="ttdeci">void ws2812_tx_byte(ws2812 *dev, uint8_t byte)</div><div class="ttdoc">Transmits a byte of data to the WS2812 device.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8c_source.html#l00190">ws2812_avr.c:190</a></div></div>
<div class="ttc" id="astructws2812_html_aac098f9c6f0f802c066122e0166d6970"><div class="ttname"><a href="structws2812.html#aac098f9c6f0f802c066122e0166d6970">ws2812::rst_time_us</a></div><div class="ttdeci">uint8_t rst_time_us</div><div class="ttdoc">Time required for WS2812 to reset in us.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00080">ws2812_avr.h:80</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_a9131a1de83995aa8c917e1a3c6ee1fa5"><div class="ttname"><a href="structws2812__cfg.html#a9131a1de83995aa8c917e1a3c6ee1fa5">ws2812_cfg::rst_time_us</a></div><div class="ttdeci">uint8_t rst_time_us</div><div class="ttdoc">Time required for WS2812 to reset in us.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00061">ws2812_avr.h:61</a></div></div>
<div class="ttc" id="aws2812__avr_8c_html_a8069aef456aba6f66b80ac92a4746a32"><div class="ttname"><a href="ws2812__avr_8c.html#a8069aef456aba6f66b80ac92a4746a32">delay_us</a></div><div class="ttdeci">void delay_us(uint8_t us)</div><div class="ttdoc">Halts the program for a given ammount of microseconds.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8c_source.html#l00115">ws2812_avr.c:115</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_a68fff035f1137f78fc80e9f9bc0fb831"><div class="ttname"><a href="structws2812__cfg.html#a68fff035f1137f78fc80e9f9bc0fb831">ws2812_cfg::port</a></div><div class="ttdeci">volatile uint8_t * port</div><div class="ttdoc">PORT Register (ex. PORTB, PORTC, PORTD...)</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00052">ws2812_avr.h:52</a></div></div>
<div class="ttc" id="astructws2812_html_ad04d92a4b1276fbb588960ad009b67b9"><div class="ttname"><a href="structws2812.html#ad04d92a4b1276fbb588960ad009b67b9">ws2812::masklo</a></div><div class="ttdeci">uint8_t masklo</div><div class="ttdoc">PORT masks to toggle the data pins low.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00082">ws2812_avr.h:82</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_a2a6404a5d1e6d8829e2abcf5d916715b"><div class="ttname"><a href="structws2812__cfg.html#a2a6404a5d1e6d8829e2abcf5d916715b">ws2812_cfg::n_dev</a></div><div class="ttdeci">uint8_t n_dev</div><div class="ttdoc">Number of WS2812 devices driven.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00063">ws2812_avr.h:63</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_ae4f693b8495942acae05da3df3bcfa58"><div class="ttname"><a href="structws2812__cfg.html#ae4f693b8495942acae05da3df3bcfa58">ws2812_cfg::pins</a></div><div class="ttdeci">uint8_t * pins</div><div class="ttdoc">Array of pins used to program WS2812 devices (Must share the same PORT! (ex. PB0, PB1,...</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00054">ws2812_avr.h:54</a></div></div>
<div class="ttc" id="aws2812__common_8c_html_abb76184063c2d58324bde5457e32bee0"><div class="ttname"><a href="ws2812__common_8c.html#abb76184063c2d58324bde5457e32bee0">_ws2812_get_rgbmap</a></div><div class="ttdeci">void _ws2812_get_rgbmap(uint8_t(*rgbmap)[3], ws2812_order order)</div><div class="ttdoc">Initializes a rgb map for a given color order.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__common_8c_source.html#l00043">ws2812_common.c:43</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_ad50d0defcc33c93e648889222b93c1aa"><div class="ttname"><a href="structws2812__cfg.html#ad50d0defcc33c93e648889222b93c1aa">ws2812_cfg::order</a></div><div class="ttdeci">ws2812_order order</div><div class="ttdoc">Color order (ex. rgb, grb, bgr...)</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00062">ws2812_avr.h:62</a></div></div>
<div class="ttc" id="astructws2812_html_a8d961104f06a5bd3f8109f0b6a89f142"><div class="ttname"><a href="structws2812.html#a8d961104f06a5bd3f8109f0b6a89f142">ws2812::rgbmap</a></div><div class="ttdeci">uint8_t rgbmap[3]</div><div class="ttdoc">RGB map to map/convert RGB values to another color order.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00083">ws2812_avr.h:83</a></div></div>
<div class="ttc" id="astructws2812__cfg_html_a05c7bc58ea6e94f80e5b4b7f0ab3a554"><div class="ttname"><a href="structws2812__cfg.html#a05c7bc58ea6e94f80e5b4b7f0ab3a554">ws2812_cfg::ddr</a></div><div class="ttdeci">volatile uint8_t * ddr</div><div class="ttdoc">Data Direction Register (ex. DDRB, DDRC, DDRD...)</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00053">ws2812_avr.h:53</a></div></div>
<div class="ttc" id="astructws2812_html_af8a9e3c5bbc7cd936d94ad33bca218dd"><div class="ttname"><a href="structws2812.html#af8a9e3c5bbc7cd936d94ad33bca218dd">ws2812::port</a></div><div class="ttdeci">volatile uint8_t * port</div><div class="ttdoc">PORT register of pins used to drive the WS2812 device(s).</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00079">ws2812_avr.h:79</a></div></div>
<div class="ttc" id="astructws2812_html_ae191c20dea8f9cca0bb92e9d0431f721"><div class="ttname"><a href="structws2812.html#ae191c20dea8f9cca0bb92e9d0431f721">ws2812::maskhi</a></div><div class="ttdeci">uint8_t maskhi</div><div class="ttdoc">PORT masks to toggle the data pins high.</div><div class="ttdef"><b>Definition:</b> <a href="ws2812__avr_8h_source.html#l00081">ws2812_avr.h:81</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
